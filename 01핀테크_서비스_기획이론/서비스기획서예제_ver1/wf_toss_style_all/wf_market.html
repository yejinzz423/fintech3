<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WF-03 ë§ˆì¼“ í™”ë©´</title>
  <link rel="stylesheet" href="styles.css">

  <!-- React CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>

<body>
<div class="mobile-container">
  <div id="root"></div>
</div>

<script type="text/babel" data-presets="react">

/* -----------------------------
   ê³µí†µ AppBar ì»´í¬ë„ŒíŠ¸
------------------------------ */
function AppBar({ title }) {
  return (
    <header className="appbar">
      <div className="appbar__title">{title}</div>
      <div className="appbar__actions">
        <button className="icon-button">ğŸ”</button>
        <button className="icon-button">ğŸ””</button>
      </div>
    </header>
  );
}

/* -----------------------------
   í•˜ë‹¨ íƒ­ ë°” ê³µí†µ ì»´í¬ë„ŒíŠ¸
------------------------------ */
function BottomNav({ active }) {
  const items = ["í™ˆ", "ë§ˆì¼“", "ë¼ì´ë¸Œ", "ì»¤ë®¤ë‹ˆí‹°", "ë§ˆì´"];

  return (
    <nav className="bottom-nav">
      {items.map((name) => (
        <button
          key={name}
          type="button"
          className={
            "bottom-nav__item" +
            (active === name ? " bottom-nav__item--active" : "")
          }
        >
          <span className="bottom-nav__label">{name}</span>
        </button>
      ))}
    </nav>
  );
}

/* -----------------------------
   WF-03 ë§ˆì¼“ í™”ë©´
   - FR-020: ì¹´í…Œê³ ë¦¬ íƒ­
   - FR-021: ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ ì œê³µ
   - FR-022: ìƒì„¸ ëª¨ë‹¬
   - UI-004 ëŒ€ì‘
------------------------------ */
function MarketScreen() {
  const categories = ["ì „ì²´", "ê³µëª¨ì£¼", "ETF", "ì±„ê¶Œ", "ë¦¬ì¸ "];

  // ğŸ¯ ë”ë¯¸ ìƒí’ˆ ë°ì´í„°
  const dummyItems = [
    {
      id: 1,
      name: "ì—ì½”ê·¸ë¦° ê³µëª¨ì£¼ ì²­ì•½",
      code: "IPO-2401",
      category: "ê³µëª¨ì£¼",
      risk_level: "mid",
      expected_yield: 12.4,
      description: "ì¹œí™˜ê²½ ì—ë„ˆì§€ ê¸°ì—… ì—ì½”ê·¸ë¦°ì˜ ì‹ ê·œ ìƒì¥ ê³µëª¨ì£¼ì…ë‹ˆë‹¤."
    },
    {
      id: 2,
      name: "KODEX 200 ETF",
      code: "ETF-200",
      category: "ETF",
      risk_level: "low",
      expected_yield: 4.8,
      description: "êµ­ë‚´ ëŒ€í‘œ ì§€ìˆ˜ KOSPI200ì„ ì¶”ì¢…í•˜ëŠ” ETF ìƒí’ˆì…ë‹ˆë‹¤."
    },
    {
      id: 3,
      name: "ë¯¸ë˜í˜• ì„±ì¥ ETF",
      code: "ETF-500",
      category: "ETF",
      risk_level: "high",
      expected_yield: 8.2,
      description: "ì‹ ì¬ìƒÂ·AIÂ·ë°”ì´ì˜¤ ë“± ì„±ì¥ í…Œë§ˆ ê¸°ë°˜ ETF."
    },
    {
      id: 4,
      name: "êµ­ì±„ 10ë…„ ë§Œê¸° ì±„ê¶Œ",
      code: "BOND-10Y",
      category: "ì±„ê¶Œ",
      risk_level: "low",
      expected_yield: 3.1,
      description: "ëŒ€í•œë¯¼êµ­ êµ­ì±„ 10ë…„ë¬¼, ì•ˆì •ì ì¸ ê¸ˆë¦¬ ê¸°ë°˜ ìƒí’ˆ."
    },
    {
      id: 5,
      name: "ìŠ¤íƒ€ë¦¬ì¸  ìƒì¥ë¦¬ì¸ ",
      code: "REIT-STAR",
      category: "ë¦¬ì¸ ",
      risk_level: "mid",
      expected_yield: 6.0,
      description: "ì˜¤í”¼ìŠ¤Â·ìƒì—…ì‹œì„¤ ì¤‘ì‹¬ì˜ ë¦¬ì¸  í¬íŠ¸í´ë¦¬ì˜¤."
    }
  ];

  const riskLabelMap = { low: "ë‚®ìŒ", mid: "ì¤‘ê°„", high: "ë†’ìŒ" };

  const [category, setCategory] = React.useState("ì „ì²´");
  const [items, setItems] = React.useState(dummyItems);
  const [selected, setSelected] = React.useState(null);

  // ì¹´í…Œê³ ë¦¬ í•„í„°ë§
  React.useEffect(() => {
    if (category === "ì „ì²´") {
      setItems(dummyItems);
    } else {
      setItems(dummyItems.filter(item => item.category === category));
    }
  }, [category]);

  return (
    <div className="screen">
      <AppBar title="ë§ˆì¼“" />

      <div className="screen__content">
        {/* FR-020 ì¹´í…Œê³ ë¦¬ íƒ­ */}
        <div className="chip-row">
          {categories.map(cat => (
            <button 
              key={cat}
              className={"chip" + (category === cat ? " chip--active" : "")}
              onClick={() => setCategory(cat)}
            >
              {cat}
            </button>
          ))}
        </div>

        {/* FR-021 ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ */}
        <section className="card">
          <h2>ìƒí’ˆ ë¦¬ìŠ¤íŠ¸</h2>

          <ul className="market-list">
            {items.map(item => (
              <li 
                key={item.id}
                className="market-list__item"
                onClick={() => setSelected(item)}
              >
                <div className="market-list__title">{item.name}</div>
                <div className="market-list__meta">
                  <span>{item.category}</span>
                  <span>{item.code}</span>
                  <span className={"risk risk--" + item.risk_level}>
                    ìœ„í—˜ë„ {riskLabelMap[item.risk_level]}
                  </span>
                </div>
              </li>
            ))}
          </ul>
        </section>

      {/* FR-A03: ë§ˆì¼“ AI ì¶”ì²œ (í–¥í›„) */}
        <p
          style={{
            fontSize: "12px",
            color: "#6b7280",
            marginTop: "8px",
          }}
        >
          â€» í–¥í›„ ë²„ì „ì—ì„œëŠ” ì‚¬ìš©ìì˜ ë³´ìœ  ìì‚°Â·ì‹œì²­ ë¼ì´ë¸Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ
          AIê°€ ìœ ì‚¬ í…Œë§ˆ ìƒí’ˆì„ ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ë¡œ ì œê³µí•©ë‹ˆë‹¤.
        </p>




        {/* FR-022 ìƒí’ˆ ìƒì„¸ ëª¨ë‹¬ */}
        {selected && (
          <div className="modal" onClick={() => setSelected(null)}>
            <div className="modal__content" onClick={e => e.stopPropagation()}>
              <h3>{selected.name}</h3>

              <p className="modal__code">{selected.code}</p>
              <p style={{ marginTop: "8px" }}>{selected.description}</p>

              <p style={{ marginTop: "8px" }}>
                ì˜ˆìƒ ìˆ˜ìµë¥ :{" "}
                <strong>{selected.expected_yield}%</strong>
              </p>

              <p
                className={"risk risk--" + selected.risk_level}
                style={{ marginTop: "8px" }}
              >
                ìœ„í—˜ë„: {riskLabelMap[selected.risk_level]}
              </p>

              <button
                className="btn"
                style={{ marginTop: "16px" }}
                onClick={() => setSelected(null)}
              >
                ë‹«ê¸°
              </button>

              <button
                className="btn btn--secondary"
                style={{ marginTop: "8px", width: "100%" }}
                onClick={() => alert("AIì—ê²Œ ë¬¼ì–´ë³´ê¸°(ì™€ì´ì–´í”„ë ˆì„ìš©)")}>
                ì´ ìƒí’ˆ, AIì—ê²Œ ë¬¼ì–´ë³´ê¸°
              </button>
            </div>
          </div>
        )}
      </div>

      {/* í•˜ë‹¨ íƒ­ ë°”: ë§ˆì¼“ í™œì„±í™” */}
      <BottomNav active="ë§ˆì¼“" />
    </div>
  );
}

// React 18 ë Œë”
const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(<MarketScreen />);
</script>

</body>
</html>
